{# mysales/templates/mysales/invoice_pdf_template.html #}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Comprobante de Pago</title>
    <style>
        /* --- TU CSS SE MANTIENE EXACTAMENTE IGUAL --- */
        @page {
            size: a4 portrait;
            @frame header_frame { -pdf-frame-content: header_content; left: 50pt; width: 512pt; top: 50pt; height: 100pt; }
            @frame content_frame { left: 50pt; width: 512pt; top: 160pt; height: 600pt; }
            @frame footer_frame { -pdf-frame-content: footer_content; left: 50pt; width: 512pt; top: 772pt; height: 20pt; }
        }
        body { font-family: "Helvetica", sans-serif; font-size: 11px; }
        .header { text-align: right; }
        .header .company-name { font-size: 24px; font-weight: bold; color: #333; }
        .header .company-info { font-size: 12px; color: #666; }
        .invoice-details { border: 1px solid #ccc; padding: 10px; margin-top: 20px; }
        .invoice-details h2 { font-size: 18px; text-align: center; margin: 0 0 10px 0; background-color: #f2f2f2; padding: 5px;}
        .customer-info { margin-top: 30px; }
        .items-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .items-table th, .items-table td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        .items-table th { background-color: #f2f2f2; font-weight: bold; }
        .items-table .text-right { text-align: right; }
        .totals-table { float: right; width: 40%; margin-top: 20px; }
        .totals-table td { padding: 5px; }
        .footer { text-align: center; font-size: 9px; color: #888; }
    </style>
</head>
<body>
    <div id="header_content">
        <div class="header">
            <div class="company-name">FG SHOP</div>
            <div class="company-info">
                RUC: 20123456789<br>
                Av. Principal 123, Lima, Perú<br>
                contacto@fgshop.com
            </div>
        </div>
    </div>

    <div id="footer_content" class="footer">
        Página <pdf:pagenumber> de <pdf:pagecount>
    </div>

    <div class="invoice-details">
        {# --- ¡CAMBIO #1: El título ahora es dinámico! --- #}
        <h2>{{ order.get_tipo_comprobante_display|upper }} ELECTRÓNICA</h2>
        <strong>Nº:</strong> {{ order.id_display }}<br>
        <strong>Fecha de Emisión:</strong> {{ order.fecha_pedido|date:"d/m/Y" }}
    </div>

    <div class="customer-info">
        {# --- ¡CAMBIO #2: La información del cliente ahora es condicional! --- #}
        {% if order.tipo_comprobante == 'FACTURA' %}
            {# --- Esto se muestra solo si es FACTURA --- #}
            <strong>Cliente:</strong> {{ order.razon_social|default:"(No especificado)" }}<br>
            <strong>RUC:</strong> {{ order.ruc|default:"(No especificado)" }}<br>
            <strong>Dirección Fiscal:</strong> {{ order.direccion_fiscal|default:"(No especificado)" }}
        {% else %}
            {# --- Esto se muestra si es BOLETA o cualquier otra cosa --- #}
            <strong>Cliente:</strong> {{ order.nombre_cliente|default:"(No especificado)" }}<br>
            <strong>DNI:</strong> {{ order.dni_cliente|default:"(No especificado)" }}<br>
            <strong>Dirección:</strong> {{ order.direccion_envio }}
        {% endif %}
    </div>

    {# --- El resto de la tabla de ítems y totales se queda EXACTAMENTE IGUAL --- #}
    <table class="items-table">
        <thead>
            <tr>
                <th>Cant.</th>
                <th>Descripción</th>
                <th class="text-right">P. Unit.</th>
                <th class="text-right">Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order.items.all %}
            <tr>
                <td>{{ item.cantidad }}</td>
                <td>{{ item.nombre_producto }}</td>
                <td class="text-right">S/ {{ item.precio_unitario_variante|floatformat:2 }}</td>
                <td class="text-right">S/ {{ item.get_costo_total|floatformat:2 }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <table class="totals-table">
        <tr>
            <td><strong>Subtotal:</strong></td>
            <td class="text-right">S/ {{ subtotal_sin_igv|floatformat:2 }}</td>
        </tr>
        <tr>
            <td><strong>IGV (18%):</strong></td>
            <td class="text-right">S/ {{ igv_calculado|floatformat:2 }}</td>
        </tr>
        <tr>
            <td><strong>Total a Pagar:</strong></td>
            <td class="text-right"><strong>S/ {{ order.total_pedido|floatformat:2 }}</strong></td>
        </tr>
    </table>

</body>
</html>